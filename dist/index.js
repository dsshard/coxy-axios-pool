'use strict';var l=require('axios'),x=require('promise.any');function _interopDefault(e){return e&&e.__esModule?e:{default:e}}var l__default=/*#__PURE__*/_interopDefault(l);var x__default=/*#__PURE__*/_interopDefault(x);function h(u,...e){let t=new p(u,...e),s={get:(o,i)=>async(r,a,n)=>{if(t[i])return t[i](r,a,n)}};return new Proxy({},s)}var p=class{constructor(e,...t){this.currentIndex=0;let s=[];for(let o of t)typeof o=="string"?s.push(l__default.default.create({baseURL:o})):s.push(o);this.options={sendAll:e?.sendAll===void 0?true:e.sendAll,timeout:e?.timeout===void 0?0:e?.timeout,validateResponse:e?.validateResponse?e?.validateResponse:()=>Promise.resolve()},this.pool=s;}async get(e,t){return this.request({method:"get",url:e,...t})}async post(e,t,s){return this.request({method:"post",data:t,url:e,...s})}async delete(e,t,s){return this.request({method:"delete",data:t,url:e,...s})}async put(e,t,s){return this.request({method:"put",data:t,url:e,...s})}async request(e){if(this.options.sendAll){let s=new AbortController,o=[];for(let r of this.pool)o.push(r.request({...e,signal:s.signal,transformResponse:[a=>{let n;try{n=JSON.parse(a);}catch{}return n?(this.options.validateResponse(n),n):(this.options.validateResponse(a),a)}]}));let i=x__default.default(o);return i.then(async r=>(s.abort(),r)).catch(()=>null),i}let t=this.pool[this.currentIndex];try{let s=await t.request(e);return this.options.validateResponse(s.data),this.currentIndex=0,s}catch(s){if(this.pool[this.currentIndex+1])return this.options.timeout>0&&await new Promise(o=>setTimeout(o,this.options.timeout)),this.currentIndex+=1,this.request(e);throw this.currentIndex=0,s}}},c=class{constructor(e,t){this.id=0;this.pool=h(t,...e);}async request(e,...t){return this.id+=1,await this.pool.post("/",{jsonrpc:"2.0",id:this.id,method:e,params:t||[]})}};exports.AxiosPool=p;exports.RpcAxiosPool=c;exports.createAxiosPool=h;//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map