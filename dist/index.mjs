import h from'axios';var c=n=>new Promise((e,t)=>{if(n.length===0){t(new Error("All Promises rejected"));return}let s=[],o=0;for(let r of n)Promise.resolve(r).then(e).catch(i=>{s.push(i),o++,o===n.length&&t(new Error(s.join(`
`)));});});function x(n,...e){let t=new l(n,...e),s={get:(o,r)=>async(i,u,a)=>{if(t[r])return t[r](i,u,a)}};return new Proxy({},s)}var l=class{constructor(e,...t){this.currentIndex=0;let s=[];for(let o of t)typeof o=="string"?s.push(h.create({baseURL:o})):s.push(o);this.options={sendAll:e?.sendAll===void 0?true:e.sendAll,timeout:e?.timeout===void 0?0:e?.timeout,validateResponse:e?.validateResponse?e?.validateResponse:()=>Promise.resolve()},this.pool=s;}async get(e,t){return this.request({method:"get",url:e,...t})}async post(e,t,s){return this.request({method:"post",data:t,url:e,...s})}async delete(e,t,s){return this.request({method:"delete",data:t,url:e,...s})}async put(e,t,s){return this.request({method:"put",data:t,url:e,...s})}async request(e){if(this.options.sendAll){let s=new AbortController,o=[];for(let i of this.pool)o.push(i.request({...e,signal:s.signal,transformResponse:[u=>{let a;try{a=JSON.parse(u);}catch{}return a?(this.options.validateResponse(a),a):(this.options.validateResponse(u),u)}]}));let r=c(o);return r.then(async i=>(s.abort(),i)).catch(()=>null),r}let t=this.pool[this.currentIndex];try{let s=await t.request(e);return this.options.validateResponse(s.data),this.currentIndex=0,s}catch(s){if(this.pool[this.currentIndex+1])return this.options.timeout>0&&await new Promise(o=>setTimeout(o,this.options.timeout)),this.currentIndex+=1,this.request(e);throw this.currentIndex=0,s}}},p=class{constructor(e,t){this.id=0;this.pool=x(t,...e);}async request(e,...t){return this.id+=1,await this.pool.post("/",{jsonrpc:"2.0",id:this.id,method:e,params:t||[]})}};export{l as AxiosPool,p as RpcAxiosPool,x as createAxiosPool};//# sourceMappingURL=index.mjs.map
//# sourceMappingURL=index.mjs.map